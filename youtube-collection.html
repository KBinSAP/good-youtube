<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="apple-mobile-web-app-title" content="KiTube">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#1a1a1a">
<link rel="apple-touch-icon" sizes="180x180" href="/good-youtube/icons/kitube.png">
<title>KiTube</title>
<link rel="manifest" href="/good-youtube/manifest.json">

<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:#0f0f0f;color:#fff;padding-bottom:80px}
.header{background:#1a1a1a;padding:16px;position:sticky;top:0;z-index:100;border-bottom:1px solid #333}
.header-top{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
.header h1{font-size:20px}
.header-buttons{display:flex;gap:8px;align-items:center}
.profile-button,.auth-button-header{background:#2a2a2a;border:1px solid #404040;color:#fff;padding:8px 12px;border-radius:8px;cursor:pointer;font-size:14px;display:flex;align-items:center;gap:6px}
.profile-button:hover,.auth-button-header:hover{background:#333}
.profile-dropdown{position:absolute;top:38px;left:0;background:#1a1a1a;border:1px solid #333;border-radius:10px;min-width:160px;padding:6px;display:none;z-index:999;box-shadow:0 10px 24px rgba(0,0,0,.6)}
.profile-option{padding:8px 10px;border-radius:6px;font-size:13px;cursor:pointer}
.profile-option:hover{background:#2a2a2a}
.profile-option.active{background:#1f2a36;border:1px solid #3ea6ff}
.search-bar{width:100%;padding:10px 12px;background:#2a2a2a;border:1px solid #404040;border-radius:8px;color:#fff}
.add-button{position:fixed;bottom:20px;right:20px;width:56px;height:56px;background:#3ea6ff;border:none;border-radius:50%;color:#fff;font-size:28px;cursor:pointer}
.modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.85);z-index:2000;align-items:center;justify-content:center;padding:20px}
.modal.active{display:flex}
.modal-content{background:#1a1a1a;border-radius:12px;padding:24px;max-width:500px;width:100%;border:1px solid #333;max-height:90vh;overflow:auto}
.close-button{background:none;border:none;color:#fff;font-size:24px;cursor:pointer}
.video-feed{padding:16px}
.video-card{background:#1a1a1a;border-radius:12px;margin-bottom:16px;border:1px solid #333;overflow:hidden}
.video-thumbnail-container{position:relative;width:100%;padding-bottom:56.25%;background:#000;cursor:pointer}
.video-thumbnail{position:absolute;inset:0;width:100%;height:100%;object-fit:cover}
.play-overlay{position:absolute;inset:0;display:flex;align-items:center;justify-content:center}
.play-icon{width:0;height:0;border-left:20px solid #fff;border-top:12px solid transparent;border-bottom:12px solid transparent}
.video-player{position:absolute;inset:0;display:none}
.video-player.active{display:block}
.video-info{padding:12px}
.video-title{font-size:15px;font-weight:500;margin-bottom:4px}
.video-description{font-size:13px;color:#aaa}
.video-meta{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:8px}
.video-tag{background:#3ea6ff;padding:4px 10px;border-radius:12px;font-size:12px}
.delete-button{background:none;border:none;color:#ff4444;font-size:12px;cursor:pointer}
</style>
</head>

<body>

<div class="header">
  <div class="header-top">
    <div style="display:flex;align-items:center;gap:10px;position:relative">
      <h1>KiTube</h1>

      <button id="profileSwitcherBtn" class="profile-button">
        <span id="activeProfileLabel">Default</span> ▾
      </button>

      <div id="profileDropdown" class="profile-dropdown"></div>
    </div>

    <div class="header-buttons">
      <button class="profile-button" id="signInHeaderButton" style="display:none">Auth, pls!</button>
      <button class="auth-button-header" id="authButtonHeader" style="display:none">⚙️</button>
    </div>
  </div>

  <input class="search-bar" id="searchInput" placeholder="Search by title, description, or tags...">
</div>

<div class="video-feed" id="videoFeed"></div>
<button class="add-button" id="addButton" style="display:none">+</button>

<script>
let videoData={profiles:["Default"],videos:[]}
let activeProfile=localStorage.getItem("activeProfile")||"Default"

const profileBtn=document.getElementById("profileSwitcherBtn")
const dropdown=document.getElementById("profileDropdown")
const label=document.getElementById("activeProfileLabel")
const videoFeed=document.getElementById("videoFeed")

function renderProfileDropdown(){
  dropdown.innerHTML=videoData.profiles.map(p=>`
    <div class="profile-option ${p===activeProfile?"active":""}" onclick="setActiveProfile('${p}')">
      ${p}
    </div>
  `).join("")
  label.textContent=activeProfile
}

profileBtn.onclick=()=>{
  dropdown.style.display=dropdown.style.display==="block"?"none":"block"
}

document.addEventListener("click",e=>{
  if(!profileBtn.contains(e.target)&&!dropdown.contains(e.target)){
    dropdown.style.display="none"
  }
})

function setActiveProfile(p){
  activeProfile=p
  localStorage.setItem("activeProfile",p)
  dropdown.style.display="none"
  renderProfileDropdown()
  renderVideos()
}

function renderVideos(){
  const list=videoData.videos.filter(v=>v.profile===activeProfile)
  videoFeed.innerHTML=list.length?list.map(v=>`
    <div class="video-card">
      <div class="video-thumbnail-container">
        <img class="video-thumbnail" src="https://img.youtube.com/vi/${v.id}/hqdefault.jpg">
        <div class="play-overlay"><div class="play-icon"></div></div>
      </div>
      <div class="video-info">
        <div class="video-title">${v.title}</div>
        ${v.description?`<div class="video-description">${v.description}</div>`:""}
      </div>
    </div>
  `).join(""):`<div style="text-align:center;color:#666;padding:60px">No videos in ${activeProfile}</div>`
}

renderProfileDropdown()
renderVideos()
</script>

</body>
</html>
